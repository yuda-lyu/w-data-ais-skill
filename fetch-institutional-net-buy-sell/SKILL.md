---
name: fetch-institutional-net-buy-sell
description: æŠ“å–å°è‚¡ã€Œä¸‰å¤§æ³•äººè²·è³£è¶…ã€æŒ‡å®šæ—¥æœŸã€æŒ‡å®šå€‹è‚¡çš„æ˜ç´°è³‡æ–™ï¼ˆå¤–è³‡/æŠ•ä¿¡/è‡ªç‡Ÿ/åˆè¨ˆï¼‰ã€‚å„ªå…ˆä½¿ç”¨å®˜æ–¹ä¾†æºï¼ˆTWSE + TPEXï¼‰ä»¥ç¢ºä¿ç©©å®šæ€§èˆ‡å¯æŒ‡å®šæ—¥æœŸã€‚é©ç”¨æ–¼ï¼š(1) ç›¤å¾Œå ±å‘Šé€æª”è£œé½Šæ³•äººè²·è³£è¶…ã€(2) é©—è­‰ç›¤å‰ç ”åˆ¤ï¼ˆæ³•äººè²·è¶…/è³£è¶…ï¼‰æ˜¯å¦å»¶çºŒã€(3) éœ€è¦å¯é‡è¤‡ã€å¯è¿½æº¯çš„æ³•äººè³‡æ–™æŠ“å–æµç¨‹ã€‚
---

# fetch-institutional-net-buy-sellï¼ˆæ³•äººè²·è³£è¶…ï¼›å®˜æ–¹ç‰ˆï¼‰

> æ­·å²ç‰ˆæœ¬æ›¾ä½¿ç”¨ Goodinfo ç¶²é æ¦œå–®æŠ“å–ï¼ˆTop10ï¼‰ï¼Œä½†ç„¡æ³•è¦†è“‹ã€Œæ¯ä¸€æª”å€‹è‚¡ã€ä¸”å— anti-bot å½±éŸ¿ã€‚
> ç›®å‰æ­¤æŠ€èƒ½æ”¹ç‚º **å®˜æ–¹ä¾†æºå„ªå…ˆ**ï¼ˆTWSE + TPEXï¼‰ï¼Œæ”¯æ´ã€ŒæŒ‡å®šæ—¥æœŸ + æŒ‡å®šä»£ç¢¼ã€ç©©å®šæŠ“å–ã€‚

## ç¶²ç«™è³‡è¨Š

| é …ç›® | èªªæ˜ |
|------|------|
| ç¶²å€ (ä¸Šå¸‚) | https://www.twse.com.tw/fund/T86 |
| ç¶²å€ (ä¸Šæ«ƒ) | https://www.tpex.org.tw/web/stock/3insti/daily_trade/3itrade_hedge_result.php |
| è³‡æ–™é¡å‹ | ä¸‰å¤§æ³•äººè²·è³£è¶…æ—¥å ± (å¤–è³‡/æŠ•ä¿¡/è‡ªç‡Ÿå•†) |
| æŠ“å–æ–¹å¼ | Node.js Axios Script |
| æ›´æ–°æ™‚é–“ | æ¯æ—¥ 15:00 å¾Œ |

## æœ€ä½³å¯¦è¸ï¼šä½¿ç”¨ Node.js Axios Scripts

å»ºè­°ä½¿ç”¨æœ¬æŠ€èƒ½é™„å¸¶çš„ Node.js è…³æœ¬é€²è¡ŒæŠ“å–ï¼Œç©©å®šæ€§é«˜ä¸”æ”¯æ´å®Œæ•´è³‡æ–™è§£æã€‚

### å‰ç½®éœ€æ±‚
1. ç¢ºä¿ç’°å¢ƒå·²å®‰è£ Node.jsã€‚
2. åœ¨å·¥ä½œå€å®‰è£ä¾è³´ï¼š`npm install axios`ã€‚

### åŸ·è¡Œæ–¹å¼

1. **è¤‡è£½è…³æœ¬**ï¼šå°‡ `scripts/` ä¸‹çš„æ‰€æœ‰ `.mjs` æª”æ¡ˆè¤‡è£½åˆ°å·¥ä½œå€ã€‚
2. **å®‰è£ä¾è³´**ï¼š`npm install axios`ã€‚
3. **åŸ·è¡ŒæŠ“å–**ï¼š
   - æŠ“å–ä¸Šå¸‚ (TWSE)ï¼š`node fetch_twse_t86.mjs`
   - æŠ“å–ä¸Šæ«ƒ (TPEX)ï¼š`node fetch_tpex_3insti.mjs`
   - **ä¸€æ¬¡æŠ“å–å…©è€…**ï¼š`node fetch_all.mjs`

### è¼¸å‡ºçµæœ
è…³æœ¬æœƒè¼¸å‡º JSON æ ¼å¼è³‡æ–™ï¼ˆåŒ…åœ¨ `JSON_OUTPUT_START` æ¨™è¨˜ä¸­ï¼‰ï¼Œä¸¦åœ¨å·¥ä½œå€ç”¢ç”Ÿå‚™ä»½æª”æ¡ˆï¼š
- `twse_t86_YYYYMMDD.json`
- `tpex_3insti_YYYYMMDD.json`

## è¼¸å‡ºæ ¼å¼

```json
{
  "source": "twse+tpex",
  "date": "20260205",
  "dateROC": "115/02/05",
  "items": [
    {
      "code": "3481",
      "name": "ç¾¤å‰µ",
      "market": "TWSE",
      "foreignNet": -124462,
      "investNet": 0,
      "dealerNet": 0,
      "totalNet": -124462,
      "raw": {
        "foreignBuy": 0,
        "foreignSell": 0,
        "investBuy": 0,
        "investSell": 0,
        "dealerBuy": 0,
        "dealerSell": 0
      }
    }
  ],
  "missing": ["6610"],
  "error": null
}
```

## ğŸ“ éŒ¯èª¤ç´€éŒ„æ©Ÿåˆ¶ï¼ˆå¿…è¦ï¼‰

åŸ·è¡Œéç¨‹ä¸­é­é‡çš„éŒ¯èª¤é ˆè¨˜éŒ„è‡³èª¿ç”¨æ–¹çš„ `error_log.jsonl`ã€‚

### ç´€éŒ„æ ¼å¼

æ¯è¡Œä¸€ç­† JSONï¼Œè¿½åŠ å¯«å…¥ï¼ˆä¸è¦†è“‹ï¼‰ï¼š

```json
{
  "timestamp": "2026-02-05T08:15:30+08:00",
  "date": "20260205",
  "source": "institutional",
  "phase": "fetch",
  "error": {
    "type": "network",
    "message": "API request failed",
    "details": "TWSE T86 API returned status: å¾ˆæŠ±æ­‰ï¼Œæ²’æœ‰ç¬¦åˆæ¢ä»¶çš„è³‡æ–™!"
  },
  "attempts": [
    {"action": "retry after 5s", "result": "failed"}
  ],
  "resolution": "failed",
  "notes": "Possibly a holiday or data not yet available"
}
```

### æ¬„ä½èªªæ˜

| æ¬„ä½ | å¿…è¦ | èªªæ˜ |
|------|------|------|
| `timestamp` | âœ… | ISO 8601 æ ¼å¼ï¼Œå«æ™‚å€ |
| `date` | âœ… | åŸ·è¡Œæ—¥æœŸï¼ˆYYYYMMDDï¼‰ |
| `source` | âœ… | å›ºå®šç‚º `institutional` |
| `phase` | âœ… | éšæ®µï¼šfetch / parse |
| `error.type` | âœ… | network / timeout / parse / empty / blocked |
| `error.message` | âœ… | ç°¡çŸ­éŒ¯èª¤è¨Šæ¯ |
| `attempts` | âŒ | é‡è©¦ç´€éŒ„ï¼ˆé¸å¡«ï¼‰ |
| `resolution` | âœ… | success / failed |

## ğŸ”§ å¸¸è¦‹å•é¡Œèˆ‡æ’é™¤

### 1. åŸ·è¡ŒéŒ¯èª¤ (Module not found)

**ç—‡ç‹€**ï¼š
- `Cannot find module 'axios'`

**è§£æ±ºæ–¹æ³•**ï¼š
ç¢ºä¿åœ¨å·¥ä½œå€åŸ·è¡Œäº†ä¾è³´å®‰è£ï¼š
```bash
npm install axios
```

### 2. è³‡æ–™ç¼ºå¤±

**ç—‡ç‹€**ï¼š
- å›å‚³ `å¾ˆæŠ±æ­‰ï¼Œæ²’æœ‰ç¬¦åˆæ¢ä»¶çš„è³‡æ–™!`

**è§£æ±ºæ–¹æ³•**ï¼š
- ç¢ºèªç•¶æ—¥æ˜¯å¦ç‚ºäº¤æ˜“æ—¥ã€‚
- ç¢ºèªæ™‚é–“æ˜¯å¦å·²éä¸‹åˆ 3 é»ï¼ˆæ³•äººè³‡æ–™é€šå¸¸åœ¨ç›¤å¾Œ 3 é»å…¬ä½ˆï¼‰ã€‚

## å¿«é€ŸåŸ·è¡Œ

```
è«‹ä½¿ç”¨ fetch-institutional-net-buy-sell æŠ€èƒ½æŠ“å–æ³•äººè²·è³£è¶…ï¼ˆä½¿ç”¨ Axios è…³æœ¬ï¼‰ï¼š
1. ç¢ºä¿ npm ä¾è³´å·²å®‰è£
2. åŸ·è¡Œ scripts/fetch_all.mjs
3. è®€å–ä¸¦è§£æ JSON è¼¸å‡º
```
