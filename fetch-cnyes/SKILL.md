---
name: fetch-cnyes
description: æŠ“å–é‰…äº¨ç¶²ï¼ˆAnueï¼‰å°è‚¡å³æ™‚æ–°èã€‚æ”¯æ´æŒ‡å®šæ—¥æœŸç¯„åœï¼Œå›å‚³çµæ§‹åŒ– JSONã€‚é©ç”¨æ–¼å°è‚¡èª¿ç ”ã€ç”¢æ¥­æ–°èã€æ³•äººå‹•æ…‹ç­‰å³æ™‚è³‡è¨Šã€‚
---

# é‰…äº¨ç¶²è³‡æ–™æŠ“å–

å¾é‰…äº¨ç¶²ï¼ˆAnue/cnyesï¼‰æŠ“å–å°è‚¡å³æ™‚æ–°èã€‚

## ç¶²ç«™è³‡è¨Š

| é …ç›® | èªªæ˜ |
|------|------|
| ç¶²å€ | https://news.cnyes.com/news/cat/tw_stock |
| è³‡æ–™é¡å‹ | å³æ™‚æ–°èï¼ˆç”¢æ¥­å‹•æ…‹ã€æ³•äººè²·è³£ã€å€‹è‚¡æ¶ˆæ¯ï¼‰ |
| æŠ“å–æ–¹å¼ | Node.js Axios Scriptï¼ˆæ”¯æ´åˆ†é èˆ‡å»¶é²ï¼‰ |
| æ›´æ–°é »ç‡ | å³æ™‚ |

## æœ€ä½³å¯¦è¸ï¼šä½¿ç”¨ Axios Scriptï¼ˆæ¨è–¦ï¼‰

å»ºè­°ä½¿ç”¨æœ¬æŠ€èƒ½é™„å¸¶çš„ Node.js è…³æœ¬é€²è¡ŒæŠ“å–ï¼Œè©²è…³æœ¬ç›´æ¥å‘¼å«é‰…äº¨ç¶² APIï¼Œæ¯”ç€è¦½å™¨æ¸²æŸ“æ›´å¿«é€Ÿä¸”ç©©å®šã€‚

### å‰ç½®éœ€æ±‚
1. ç¢ºä¿ç’°å¢ƒå·²å®‰è£ Node.jsã€‚
2. åœ¨å·¥ä½œå€å®‰è£ä¾è³´ï¼š`npm install axios`ã€‚

### åŸ·è¡Œæ–¹å¼

1. **è®€å–è…³æœ¬**ï¼šå¾æŠ€èƒ½ç›®éŒ„è®€å– `scripts/fetch_cnyes.mjs`ã€‚
2. **åŸ·è¡Œè…³æœ¬**ï¼šä½¿ç”¨ `node` åŸ·è¡Œè©²è…³æœ¬ã€‚
3. **è§£æè¼¸å‡º**ï¼šè…³æœ¬æœƒå°‡çµæœä»¥ JSON æ ¼å¼è¼¸å‡ºï¼ˆåŒ…åœ¨ `JSON_OUTPUT_START` èˆ‡ `JSON_OUTPUT_END` ä¹‹é–“ï¼‰ã€‚

```bash
# ç¯„ä¾‹
cp /path/to/skill/scripts/fetch_cnyes.mjs .
npm install axios
node fetch_cnyes.mjs
```

### è…³æœ¬é‚è¼¯æ‘˜è¦
- ä½¿ç”¨ `axios` å‘¼å«é‰…äº¨ç¶²å®˜æ–¹ API (`https://api.cnyes.com/media/api/v1/newslist/category/tw_stock`)ã€‚
- å…§å»ºåˆ†é é‚è¼¯ï¼Œè‡ªå‹•ç¿»é æŠ“å–æœ€è¿‘ 100 ç­†æ–°èã€‚
- è‡ªå‹•è™•ç†æ—¥æœŸæ ¼å¼èˆ‡é€£çµã€‚
- è¼¸å‡ºçµæ§‹åŒ– JSONã€‚

---

## è¼¸å‡ºæ ¼å¼

```json
{
  "source": "cnyes",
  "fetchTime": "2026-02-05T08:00:00+08:00",
  "dateRange": {
    "from": "2026-02-04",
    "to": "2026-02-05"
  },
  "items": [
    {
      "title": "å°ç©é›»æ³•èªªæœƒé‡‹æ­£å‘å±•æœ› å¤–è³‡é€£ä¸‰è²·",
      "url": "https://news.cnyes.com/news/id/...",
      "time": "ä»Šå¤© 07:45",
      "code": "2330",
      "name": "å°ç©é›»",
      "impact": "åˆ©å¤š",
      "reason": "æ³•èªªæœƒæ­£å‘å±•æœ›"
    }
  ],
  "error": null
}
```

## ç¯©é¸æ¨™æº–

### è¦æŠ“ï¼ˆæœƒå½±éŸ¿è‚¡åƒ¹ï¼‰

- æ³•äººè²·è³£è¶…å ±å°
- ç‡Ÿæ”¶/è²¡å ±ç›¸é—œæ–°è
- ç”¢æ¥­è¶¨å‹¢é‡å¤§è®ŠåŒ–
- å€‹è‚¡åˆ©å¤š/åˆ©ç©ºæ¶ˆæ¯
- å¤–è³‡å ±å‘Š/ç›®æ¨™åƒ¹

### è·³é

- ç´”ç›¤å‹¢è©•è«–ï¼ˆå¤§ç›¤åˆ†æï¼‰
- æŠ€è¡“åˆ†ææ–‡ç« 
- ä¸€èˆ¬ç”¢æ¥­ä»‹ç´¹

## å€‹è‚¡è­˜åˆ¥

å¾æ¨™é¡Œæå–è‚¡ç¥¨ä»£ç¢¼å’Œåç¨±ï¼š
- æ¨™é¡ŒåŒ…å«ã€Œå°ç©é›»ã€â†’ code: 2330
- æ¨™é¡ŒåŒ…å«ã€Œ(2330)ã€â†’ code: 2330
- ç„¡æ³•è­˜åˆ¥æ™‚ code ç•™ç©º

## éŒ¯èª¤è™•ç†

```json
{
  "source": "cnyes",
  "fetchTime": "2026-02-05T08:00:00+08:00",
  "items": [],
  "error": {
    "type": "timeout",
    "message": "Page load timeout after 30s",
    "details": "..."
  }
}
```

## ğŸ“ éŒ¯èª¤ç´€éŒ„æ©Ÿåˆ¶ï¼ˆå¿…è¦ï¼‰

åŸ·è¡Œéç¨‹ä¸­é­é‡çš„éŒ¯èª¤é ˆè¨˜éŒ„è‡³èª¿ç”¨æ–¹çš„ `error_log.jsonl`ã€‚

### ç´€éŒ„æ ¼å¼

æ¯è¡Œä¸€ç­† JSONï¼Œè¿½åŠ å¯«å…¥ï¼ˆä¸è¦†è“‹ï¼‰ï¼š

```json
{
  "timestamp": "2026-02-05T08:15:30+08:00",
  "date": "20260205",
  "source": "cnyes",
  "phase": "fetch",
  "error": {
    "type": "network",
    "message": "API request failed",
    "details": "HTTP 503 Service Unavailable"
  },
  "attempts": [
    {"action": "retry after 5s", "result": "failed"}
  ],
  "resolution": "failed",
  "notes": "API unstable"
}
```

### æ¬„ä½èªªæ˜

| æ¬„ä½ | å¿…è¦ | èªªæ˜ |
|------|------|------|
| `timestamp` | âœ… | ISO 8601 æ ¼å¼ï¼Œå«æ™‚å€ |
| `date` | âœ… | åŸ·è¡Œæ—¥æœŸï¼ˆYYYYMMDDï¼‰ |
| `source` | âœ… | å›ºå®šç‚º `cnyes` |
| `phase` | âœ… | éšæ®µï¼šfetch / parse |
| `error.type` | âœ… | network / timeout / parse / empty / blocked |
| `error.message` | âœ… | ç°¡çŸ­éŒ¯èª¤è¨Šæ¯ |
| `attempts` | âŒ | é‡è©¦ç´€éŒ„ï¼ˆé¸å¡«ï¼‰ |
| `resolution` | âœ… | success / failed |


### éŒ¯èª¤é¡å‹

| type | èªªæ˜ |
|------|------|
| `timeout` | é é¢è¼‰å…¥é€¾æ™‚ |
| `browser` | ç€è¦½å™¨æ“ä½œå¤±æ•— |
| `parse` | å…§å®¹è§£æå¤±æ•— |
| `empty` | ç„¡æ³•æ‰¾åˆ°æ–°èåˆ—è¡¨ |
| `blocked` | è¢«ç¶²ç«™å°é– |

### ä½•æ™‚ç´€éŒ„

1. HTTP è«‹æ±‚å¤±æ•— (Axios Error)
2. å›å‚³å…§å®¹ç„¡æ³•è§£æ
3. æ‰¾ä¸åˆ°é æœŸçš„æ–°èçµæ§‹
4. é‡è©¦å˜—è©¦

## ğŸ”§ å¸¸è¦‹å•é¡Œèˆ‡æ’é™¤

### 1. åŸ·è¡ŒéŒ¯èª¤ (Module not found)

**ç—‡ç‹€**ï¼š
- `Cannot find module 'axios'`

**è§£æ±ºæ–¹æ³•**ï¼š
ç¢ºä¿åœ¨å·¥ä½œå€åŸ·è¡Œäº†ä¾è³´å®‰è£ï¼š
```bash
npm install axios
```

## å¿«é€ŸåŸ·è¡Œ

```
è«‹ä½¿ç”¨ fetch-cnyes æŠ€èƒ½æŠ“å–é‰…äº¨ç¶²æ–°èï¼ˆä½¿ç”¨ Axios è…³æœ¬ï¼‰ï¼š
1. ç¢ºä¿ npm ä¾è³´å·²å®‰è£
2. åŸ·è¡Œ scripts/fetch_cnyes.mjs
3. è®€å–ä¸¦è§£æ JSON è¼¸å‡º
```
